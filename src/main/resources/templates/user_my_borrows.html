<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Borrowed Books</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        /* ================= PAGE BACKGROUND ================= */
        body {
            min-height: 100vh;
            background:
                    linear-gradient(
                            rgba(0,0,0,0.15),
                            rgba(0,0,0,0.15)
                    ),
                    url("https://images.unsplash.com/photo-1507842217343-583bb7270b66");
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            padding: 40px;
            font-family: "Segoe UI", system-ui, sans-serif;
        }

        /* ================= MAIN GLASS CARD ================= */
        .glass-wrapper {
            background:
                    linear-gradient(135deg, #fff1f2, #ffe4e6);
            border-radius: 26px;
            padding: 34px;
            box-shadow: 0 30px 70px rgba(120,20,60,0.35);
        }

        /* ================= TITLE ================= */
        .page-title {
            font-size: 34px;
            font-weight: 800;
            color: #be185d;
            margin-bottom: 28px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* ================= INFO CARD ================= */
        .info-card {
            background: rgba(255,255,255,0.9);
            border-radius: 18px;
            padding: 22px 26px;
            box-shadow: 0 14px 35px rgba(190,24,93,0.25);
            border-left: 6px solid #e11d48;
        }

        .info-card strong {
            color: #9f1239;
        }

        .info-card ul li {
            margin-bottom: 6px;
        }

        /* ================= TABLE ================= */
        table {
            border-collapse: separate;
            border-spacing: 0 12px;
        }

        thead th {
            color: #9f1239;
            font-weight: 700;
            border-bottom: none;
        }

        tbody tr {
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 22px rgba(0,0,0,0.12);
        }

        tbody td {
            padding: 16px;
            border-top: none;
        }

        tbody tr td:first-child {
            border-top-left-radius: 16px;
            border-bottom-left-radius: 16px;
        }

        tbody tr td:last-child {
            border-top-right-radius: 16px;
            border-bottom-right-radius: 16px;
        }

        /* ================= ROW STATES ================= */
        .row-returned {
            border-left: 6px solid #22c55e;
        }

        .row-active {
            border-left: 6px solid #f59e0b;
        }

        .row-overdue {
            border-left: 6px solid #ef4444;
        }

        /* ================= STATUS BADGES ================= */
        .status-badge {
            padding: 6px 14px;
            border-radius: 999px;
            font-weight: 700;
            font-size: 13px;
            display: inline-block;
        }

        .status-returned {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
        }

        .status-active {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: #1f2937;
        }

        .status-overdue {
            background: linear-gradient(135deg, #f43f5e, #e11d48);
            color: white;
        }

        /* ================= BACK BUTTON ================= */
        .btn-back {
            margin-top: 26px;
            border-radius: 999px;
            padding: 10px 24px;
            font-weight: 600;
        }
    </style>
</head>

<body>

<div class="container">
    <div class="glass-wrapper">

        <!-- ================= TITLE ================= -->
        <div class="page-title">
            üìö My Borrowed Books
        </div>

        <!-- ================= INFO ================= -->
        <div class="info-card mb-4">
            <strong>‚ö† Important information about late fees & penalties</strong>

            <p class="mt-2 mb-2">
                Please make sure to return borrowed books on time to avoid penalties.
            </p>

            <ul class="mb-2">
                <li>üìÖ Each book has a <b>due date</b> displayed below.</li>
                <li>‚è≥ Returning a book <b>after the due date</b> will generate a penalty.</li>
                <li>üí∞ <b>Late fee:</b> <span class="fw-bold text-danger">5 lei / day</span>.</li>
                <li>üîÑ Late fees are calculated <b>automatically</b> by the system.</li>
                <li>üßæ Penalties must be settled at the library desk.</li>
            </ul>

            <small class="text-muted">
                Example: If a book is returned 3 days late, the total penalty will
                <b>15 lei</b>.
            </small>
        </div>

        <!-- ================= TABLE ================= -->
        <table class="table align-middle">
            <thead>
            <tr>
                <th>Book</th>
                <th>Borrow Date</th>
                <th>Due Date</th>
                <th>Status</th>
                <th>Late Fee</th>
            </tr>
            </thead>

            <tbody>
            <tr th:each="b : ${borrows}"
                th:classappend="
                    ${b.returned} ? 'row-returned' :
                    (${b.dueDate.isBefore(T(java.time.LocalDate).now())} ? 'row-overdue' : 'row-active')
                ">

                <td>
                    <strong th:text="${b.book.title}"></strong><br>
                    <small class="text-muted" th:text="${b.book.author}"></small>
                </td>

                <td th:text="${b.borrowDate}"></td>
                <td th:text="${b.dueDate}"></td>

                <td>
                    <span class="status-badge"
                          th:classappend="
                            ${b.returned} ? 'status-returned' :
                            (${b.dueDate.isBefore(T(java.time.LocalDate).now())} ? 'status-overdue' : 'status-active')
                          "
                          th:text="
                            ${b.returned} ? 'Returned' :
                            (${b.dueDate.isBefore(T(java.time.LocalDate).now())} ? 'Overdue' : 'Active')
                          ">
                    </span>
                </td>

                <td>
                    <strong th:text="${b.lateFee}"></strong> lei
                </td>
            </tr>
            </tbody>
        </table>

        <a href="/user/home" class="btn btn-secondary btn-back">
            ‚Üê Back
        </a>

    </div>
</div>

</body>
</html>
